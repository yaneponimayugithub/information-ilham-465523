Отчет по лабораторной работе №5
Курс: Информатика
Тема: Git
Выполнил: Гашимов И.Ф. (К3139)
Проверил: Болгова К.

Цель работы
Целью работы является настройка и тестирование pre-commit hook в Git для автоматической проверки файлов перед коммитом. Для проверки используется скрипт, который позволяет убедиться, что:

Все файлы с расширением .txt содержат подпись "Автор:".
Файлы других форматов не могут быть добавлены в репозиторий.
Шаги выполнения
1. Переход в директорию проекта
Для начала, переходим в директорию с проектом git-practice:

bash
Копировать код
cd git-practide
2. Переход в папку с хуками Git
Далее переходим в директорию, где хранятся хуки Git:

bash
Копировать код
cd .git/hooks
3. Создание скрипта pre-commit
Создаем новый файл pre-commit для написания логики проверки файлов перед коммитом:

bash
Копировать код
touch pre-commit
4. Открытие файла для редактирования
Открываем файл pre-commit в текстовом редакторе (например, gedit):

bash
Копировать код
gedit pre-commit
5. Написание логики проверки в pre-commit
Вставляем следующий код в файл pre-commit:

bash
Копировать код
#!/bin/bash

# Проходим по каждому файлу, который был добавлен в индекс для коммита
for file in $(git diff --cached --name-only); do
    # Проверяем, является ли файл .txt
    if [[ $file == *.txt ]]; then
        # Проверяем, есть ли в файле строка "Автор:"
        if grep -q "Автор:" "$file"; then
            echo "Файл '$file' соответствует формату и имеет подпись автора."
        else
            # Если подписи нет, выводим ошибку
            echo "Ошибка: Файл '$file' соответствует формату, но не имеет подписи автора."
            exit 1
        fi
    else
        # Если файл не .txt, выводим ошибку
        echo "Ошибка: Файл '$file' не соответствует формату!"
        exit 1
    fi
done
6. Установка прав на выполнение скрипта
Для того чтобы Git использовал наш хук, нужно дать файлу pre-commit права на выполнение:

bash
Копировать код
chmod +x pre-commit
Описание работы скрипта
Скрипт pre-commit выполняет следующие действия:

Получение списка измененных файлов: Скрипт проверяет, какие файлы были добавлены в индекс для коммита с помощью команды git diff --cached --name-only.

Проверка формата файлов: Для каждого файла проверяется, имеет ли он расширение .txt. Если файл не является .txt, выводится ошибка и коммит блокируется.

Проверка подписи автора: Для каждого .txt файла проверяется наличие строки Автор: с помощью команды grep. Если подпись автора отсутствует, выводится ошибка, и коммит не будет выполнен.

Вывод сообщений: В консоль выводятся сообщения, соответствующие результатам проверки:

Если файл соответствует формату и содержит подпись автора, выводится сообщение о том, что файл прошел проверку.
Если файл не соответствует формату или не имеет подписи автора, выводится соответствующая ошибка.
Завершение работы скрипта: Если все проверки прошли успешно, скрипт позволяет продолжить коммит. Если хотя бы один файл не прошел проверку, скрипт завершает выполнение с ошибкой, и коммит блокируется.

Подготовка файлов для тестирования
Для проверки работы скрипта были созданы следующие файлы:

txtfile_without_author.txt — файл с текстом, но без подписи автора (не соответствует требованиям).
txtfile_with_author.txt — файл с текстом и подписью "Автор:" (соответствует требованиям).
notxt.py — файл с расширением .py, который не соответствует формату .txt.
Проведение тестов
Коммит с файлом, соответствующим формату (с подписью автора)

Создаем файл txtfile_with_author.txt с содержимым:

bash
Копировать код
echo "Это текст файла." > txtfile_with_author.txt
echo "Автор: Иванов И.И." >> txtfile_with_author.txt
Добавляем файл в индекс и делаем коммит:

bash
Копировать код
git add txtfile_with_author.txt
git commit -m "Добавлен файл с подписью автора"
Результат: Коммит прошел успешно. Вывод:

arduino
Копировать код
Файл 'txtfile_with_author.txt' соответствует формату и имеет подпись автора.
Все файлы прошли проверку, можно коммитить!
Коммит с файлом без подписи автора

Создаем файл txtfile_without_author.txt с содержимым:

bash
Копировать код
echo "Это текст файла." > txtfile_without_author.txt
Добавляем файл в индекс и пытаемся сделать коммит:

bash
Копировать код
git add txtfile_without_author.txt
git commit -m "Добавлен файл без подписи автора"
Результат: Коммит не прошел, так как файл не содержит подпись автора. Вывод:

arduino
Копировать код
Ошибка: Файл 'txtfile_without_author.txt' соответствует формату, но не имеет подписи автора.
Коммит с файлом, не соответствующим формату (.py файл)

Создаем файл notxt.py с содержимым:

bash
Копировать код
echo "Это Python файл." > notxt.py
Добавляем файл в индекс и пытаемся сделать коммит:

bash
Копировать код
git add notxt.py
git commit -m "Добавлен не .txt файл"
Результат: Коммит не прошел, так как файл не имеет расширение .txt. Вывод:

arduino
Копировать код
Ошибка: Файл 'notxt.py' не соответствует формату!
Заключение
В ходе лабораторной работы был настроен Git hook для проверки файлов перед коммитом. Скрипт проверяет, что коммитятся только .txt файлы с подписью "Автор:". Если файл не соответствует этим требованиям, коммит блокируется. Все тесты прошли успешно, и система работает как ожидается.

Результат выполнения лабораторной работы:
txtfile_with_author.txt — файл прошел проверку и был успешно закоммичен.
txtfile_without_author.txt — файл не прошел проверку из-за отсутствия подписи автора.
notxt.py — файл не прошел проверку, так как имеет неправильное расширение.
